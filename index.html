<!DOCTYPE html>
<html>
<head>
    <title>Арт-терапия: Акварель</title>
    <style>
        body { margin: 0; overflow: hidden; background: #fdfaf3; cursor: crosshair; }
        #controls { position: fixed; top: 10px; left: 10px; background: rgba(255,255,255,0.8); padding: 10px; border-radius: 8px; font-family: sans-serif; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        canvas { filter: contrast(1.1) saturate(1.2); } /* Усиливаем эффект текстуры */
    </style>
</head>
<body>
    <div id="controls">
        <input type="color" id="colorPicker" value="#4A90E2">
        <input type="range" id="sizePicker" min="10" max="100" value="40">
        <button onclick="clearCanvas()">Очистить</button>
    </div>
    <canvas id="paintCanvas"></canvas>

    <script>
        const canvas = document.getElementById('paintCanvas');
        const ctx = canvas.getContext('2d');
        let isDrawing = false;

        function resize() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
            // Имитация текстуры бумаги при старте
            ctx.fillStyle = '#fdfaf3';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
        }

        window.onresize = resize;
        resize();

        function drawWatercolor(x, y) {
            const color = document.getElementById('colorPicker').value;
            const size = document.getElementById('sizePicker').value;
            
            // Секрет акварели: много мазков с низкой прозрачностью
            for (let i = 0; i < 5; i++) {
                ctx.beginPath();
                // Случайное смещение каждого под-мазка для "рваного" края
                const offsetX = (Math.random() - 0.5) * size * 0.5;
                const offsetY = (Math.random() - 0.5) * size * 0.5;
                const radius = Math.random() * size;

                ctx.arc(x + offsetX, y + offsetY, radius, 0, Math.PI * 2);
                
                // Превращаем hex в rgba для прозрачности
                const r = parseInt(color.slice(1, 3), 16);
                const g = parseInt(color.slice(3, 5), 16);
                const b = parseInt(color.slice(5, 7), 16);
                
                ctx.fillStyle = `rgba(${r}, ${g}, ${b}, 0.03)`;
                ctx.fill();
            }
        }

        canvas.addEventListener('mousedown', () => isDrawing = true);
        canvas.addEventListener('mouseup', () => isDrawing = false);
        canvas.addEventListener('mousemove', (e) => {
            if (isDrawing) drawWatercolor(e.clientX, e.clientY);
        });

        function clearCanvas() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            resize();
        }
    </script>
</body>
</html>
