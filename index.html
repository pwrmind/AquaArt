<!DOCTYPE html>
<html>
<head>
    <title>Чистый Акварельный Холст</title>
    <style>
        body { margin: 0; overflow: hidden; background: #ffffff; cursor: crosshair; }
        #ui { 
            position: fixed; top: 20px; left: 20px; z-index: 10;
            display: flex; gap: 15px; align-items: center;
            background: white; padding: 12px; border-radius: 50px;
            box-shadow: 0 5px 25px rgba(0,0,0,0.07);
        }
        .palette { display: flex; gap: 8px; }
        .color { width: 28px; height: 28px; border-radius: 50%; cursor: pointer; border: 2px solid #eee; transition: 0.2s; }
        .active { border-color: #000; transform: scale(1.2); }
        button { border: none; background: none; cursor: pointer; font-size: 14px; color: #888; margin-left: 10px; }
    </style>
</head>
<body>

<div id="ui">
    <div class="palette" id="palette">
        <div class="color active" style="background: #5d8aa8" data-color="#5d8aa8"></div>
        <div class="color" style="background: #e3a6a1" data-color="#e3a6a1"></div>
        <div class="color" style="background: #7da67d" data-color="#7da67d"></div>
        <div class="color" style="background: #d4a373" data-color="#d4a373"></div>
        <div class="color" style="background: #333333" data-color="#333333"></div>
    </div>
    <input type="range" id="size" min="5" max="60" value="30">
    <button onclick="clearCanvas()">Очистить</button>
</div>

<canvas id="canvas"></canvas>

<script>
    const canvas = document.getElementById('canvas');
    const ctx = canvas.getContext('2d');
    let isDrawing = false;
    let lastX = 0; let lastY = 0;
    let currentColor = "#5d8aa8";

    function init() {
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
        ctx.fillStyle = '#ffffff';
        ctx.fillRect(0, 0, canvas.width, canvas.height);
    }

    function draw(x, y) {
        const size = parseInt(document.getElementById('size').value);
        const dist = Math.hypot(x - lastX, y - lastY);
        const steps = dist * 2; // Плотность заполнения линии

        for (let i = 0; i < steps; i++) {
            const ix = lastX + (x - lastX) * (i / steps);
            const iy = lastY + (y - lastY) * (i / steps);
            
            // Создаем эффект акварельного пятна через радиальный градиент
            const gradient = ctx.createRadialGradient(ix, iy, 0, ix, iy, size);
            const rgb = hexToRgb(currentColor);
            
            gradient.addColorStop(0, `rgba(${rgb}, 0.02)`);
            gradient.addColorStop(0.4, `rgba(${rgb}, 0.01)`);
            gradient.addColorStop(1, `rgba(${rgb}, 0)`);

            ctx.fillStyle = gradient;
            ctx.fillRect(ix - size, iy - size, size * 2, size * 2);
        }
        lastX = x; lastY = y;
    }

    function hexToRgb(hex) {
        const r = parseInt(hex.slice(1, 3), 16);
        const g = parseInt(hex.slice(3, 5), 16);
        const b = parseInt(hex.slice(5, 7), 16);
        return `${r},${g},${b}`;
    }

    canvas.addEventListener('mousedown', (e) => {
        isDrawing = true;
        [lastX, lastY] = [e.clientX, e.clientY];
    });

    window.addEventListener('mousemove', (e) => {
        if (isDrawing) draw(e.clientX, e.clientY);
    });

    window.addEventListener('mouseup', () => isDrawing = false);

    document.getElementById('palette').onclick = (e) => {
        if (e.target.classList.contains('color')) {
            document.querySelector('.active').classList.remove('active');
            e.target.classList.add('active');
            currentColor = e.target.dataset.color;
        }
    };

    function clearCanvas() {
        ctx.fillStyle = '#ffffff';
        ctx.fillRect(0, 0, canvas.width, canvas.height);
    }

    init();
    window.addEventListener('resize', init);
</script>
</body>
</html>
